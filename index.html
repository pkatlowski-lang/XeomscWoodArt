<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xeomsc FusionArt - Grawerowanie Laserowe i Drewno</title>
    <!-- Tailwind CSS do stylizacji -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome do ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        wood: {
                            100: '#fef3c7',
                            500: '#d97706',
                            600: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        stone: {
                            50: '#fafaf9',
                            800: '#292524',
                            900: '#1c1917',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            scroll-behavior: smooth;
        }
        .gradient-text {
            background: linear-gradient(to right, #b45309, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }
        
        .white-outline-text {
            text-shadow: 
                -1px -1px 0 #fff,  
                 1px -1px 0 #fff,
                -1px  1px 0 #fff,
                 1px  1px 0 #fff,
                 0px  0px 8px rgba(255,255,255,0.8);
        }

        .text-outline {
            text-shadow: 
                -1px -1px 2px rgba(0,0,0,0.4),  
                 1px -1px 2px rgba(0,0,0,0.4),
                -1px  1px 2px rgba(0,0,0,0.4),
                 1px  1px 2px rgba(0,0,0,0.4),
                 0px  2px 10px rgba(0,0,0,0.6);
        }

        .hero-bg {
            background-color: #fafaf9;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d6d3d1' fill-opacity='0.2' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='3'/%3E%3Ccircle cx='13' cy='13' r='3'/%3E%3C/g%3E%3C/svg%3E");
        }
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .lightbox-img {
            max-height: 85vh;
            max-width: 90vw;
            object-fit: contain;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        
        .admin-controls, .delete-btn {
            display: none !important;
        }
        body.is-admin .admin-controls, 
        body.is-admin .delete-btn {
            display: flex !important;
        }

        .hero-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .hero-slide {
            position: absolute;
            inset: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        .hero-slide.active {
            opacity: 1;
            z-index: 10;
        }
        
        .admin-sidebar-item.active {
            background-color: #b45309;
            color: white;
        }

        #admin-panel.hidden {
            display: none !important;
        }

        .calc-input {
            background: #1c1917;
            border: 1px solid #444;
            color: white;
            padding: 0.5rem;
            border-radius: 0.5rem;
            width: 100%;
            outline: none;
        }
        .calc-input:focus {
            border-color: #d97706;
        }

        /* Spreadsheet style calculations view */
        .excel-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
    </style>
</head>
<body class="text-stone-800 bg-stone-50">

    <!-- EKRAN LOGOWANIA -->
    <div id="login-screen" class="fixed inset-0 z-[300] bg-stone-900 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="mb-6 inline-block p-4 rounded-full bg-wood-100 text-wood-600 text-3xl">
                <i class="fa-solid fa-user-lock"></i>
            </div>
            <h2 class="text-2xl font-bold text-stone-900 mb-2">Panel Administratora</h2>
            <p class="text-gray-500 mb-6">Zaloguj się, aby zarządzać stroną</p>
            
            <form onsubmit="event.preventDefault(); handleLogin();" class="space-y-4 text-left">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Login</label>
                    <input type="text" id="login-user" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-wood-500 outline-none transition" placeholder="Wpisz login">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Hasło</label>
                    <input type="password" id="login-pass" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-wood-500 outline-none transition" placeholder="Wpisz hasło">
                </div>
                <div id="login-error" class="text-red-500 text-sm hidden text-center font-bold">Błędny login lub hasło!</div>
                <button type="submit" class="w-full bg-wood-600 text-white py-3 rounded-lg font-bold hover:bg-wood-700 transition shadow-lg">Zaloguj się</button>
            </form>
            <button onclick="exitLogin()" class="mt-6 text-sm text-gray-400 hover:text-wood-600 underline">Wróć do strony głównej</button>
        </div>
    </div>

    <!-- Pasek Admina -->
    <div id="admin-bar" class="hidden bg-stone-900 text-white text-sm py-2 px-4 fixed top-0 w-full z-[150] flex justify-between items-center shadow-md">
        <div class="flex items-center gap-4">
            <span class="hidden sm:inline font-semibold text-green-400"><i class="fa-solid fa-shield-halved mr-2"></i> Tryb Admina</span>
            <button onclick="toggleAdminPanel()" class="bg-wood-600 hover:bg-wood-500 text-white px-4 py-1.5 rounded text-xs font-bold transition flex items-center">
                <i class="fa-solid fa-bars-staggered mr-2"></i> Menu Zarządzania
            </button>
        </div>
        <button onclick="handleLogout()" class="hover:text-red-400 font-bold transition flex items-center"><i class="fa-solid fa-power-off mr-2"></i> Wyloguj</button>
    </div>

    <!-- Nawigacja Strony -->
    <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md shadow-sm transition-all duration-300 top-0" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex-shrink-0 flex items-center">
                    <a href="#" onclick="goHome(); window.scrollTo(0,0);" class="text-2xl font-bold text-wood-600 tracking-tighter flex items-center">
                        <i class="fa-solid fa-bolt mr-2"></i> Xeomsc FusionArt
                    </a>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <a href="#home" onclick="goHome()" class="text-gray-600 hover:text-wood-600 transition font-medium">Start</a>
                    <a href="#about" onclick="goHome()" class="text-gray-600 hover:text-wood-600 transition font-medium">O ofercie</a>
                    <a href="#portfolio" onclick="goHome()" class="text-gray-600 hover:text-wood-600 transition font-medium">Realizacje</a>
                    <a href="#contact" onclick="goHome()" class="px-5 py-2.5 bg-wood-600 text-white rounded-lg hover:bg-wood-800 transition shadow-lg font-medium">Wycena</a>
                </div>
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-gray-600 hover:text-wood-600">
                        <i class="fa-solid fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobilne Menu -->
        <div class="md:hidden hidden bg-white border-t border-stone-100" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#home" onclick="goHome(); toggleMobileMenu();" class="block px-3 py-2 rounded-md text-gray-700 hover:bg-stone-50">Start</a>
                <a href="#about" onclick="goHome(); toggleMobileMenu();" class="block px-3 py-2 rounded-md text-gray-700 hover:bg-stone-50">O ofercie</a>
                <a href="#portfolio" onclick="goHome(); toggleMobileMenu();" class="block px-3 py-2 rounded-md text-gray-700 hover:bg-stone-50">Realizacje</a>
                <a href="#contact" onclick="goHome(); toggleMobileMenu();" class="block px-3 py-2 rounded-md font-bold text-wood-600">Wycena</a>
            </div>
        </div>
    </nav>

    <!-- KONTENER GŁÓWNY -->
    <div id="main-content" class="pt-0 transition-all duration-300">
        <!-- Hero Section -->
        <section id="home" class="relative h-screen flex items-center hero-bg overflow-hidden">
            <div class="absolute inset-0 z-0" id="hero-carousel-container">
                <div class="w-full h-full bg-stone-200 animate-pulse"></div>
            </div>
            <div class="absolute inset-0 bg-black/20 z-10 pointer-events-none"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-20 w-full">
                <div class="w-full md:w-1/2 text-center md:text-left bg-white/20 md:bg-transparent backdrop-blur-sm md:backdrop-blur-none p-8 md:p-0 rounded-3xl">
                    <span class="inline-block py-1.5 px-4 rounded-full bg-wood-100/90 text-wood-800 text-xs font-bold mb-6 border border-wood-200 uppercase tracking-widest shadow-sm">
                        Pracownia Grawerska
                    </span>
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight mb-6 text-white text-outline">
                        Precyzja Lasera,<br>
                        Ciepło <span class="gradient-text white-outline-text">Drewna</span>.
                    </h1>
                    <p class="text-lg md:text-xl text-white mb-8 max-w-lg mx-auto md:mx-0 font-medium text-outline">
                        Witaj w Xeomsc FusionArt. Tworzymy spersonalizowane dekoracje, pamiątki oraz gadżety reklamowe z duszą.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                        <a href="#portfolio" class="px-8 py-3.5 bg-wood-600 text-white rounded-xl hover:bg-wood-800 transition shadow-xl font-bold text-center">Zobacz nasze prace</a>
                        <a href="#contact" class="px-8 py-3.5 bg-white/90 backdrop-blur-md text-wood-600 border border-white/50 rounded-xl hover:bg-white transition shadow-xl font-bold text-center">Wycena projektu</a>
                    </div>
                </div>
            </div>
            <div class="absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-stone-50 to-transparent z-10 pointer-events-none"></div>
        </section>

        <!-- Oferta -->
        <section id="about" class="py-24 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-4xl font-bold mb-4 text-stone-900">Co oferuję?</h2>
                <div class="w-24 h-1.5 bg-wood-600 mx-auto rounded-full mb-16"></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                    <div class="p-10 bg-stone-50 rounded-3xl border border-stone-100 hover:shadow-xl transition-shadow group">
                        <div class="w-16 h-16 bg-wood-100 text-wood-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:bg-wood-600 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-wand-magic-sparkles text-3xl"></i>
                        </div>
                        <h3 class="font-bold text-2xl mb-4">Grawerowanie</h3>
                        <p class="text-gray-600">Niezwykle precyzyjne nanoszenie detali na drewno, szkło i inne materiały.</p>
                    </div>
                    <div class="p-10 bg-stone-50 rounded-3xl border border-stone-100 hover:shadow-xl transition-shadow group">
                        <div class="w-16 h-16 bg-wood-100 text-wood-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:bg-wood-600 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-scissors text-3xl"></i>
                        </div>
                        <h3 class="font-bold text-2xl mb-4">Precyzyjne Cięcie</h3>
                        <p class="text-gray-600">Wycinanie skomplikowanych kształtów, liter i elementów dekoracyjnych.</p>
                    </div>
                    <div class="p-10 bg-stone-50 rounded-3xl border border-stone-100 hover:shadow-xl transition-shadow group">
                        <div class="w-16 h-16 bg-wood-100 text-wood-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:bg-wood-600 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-gift text-3xl"></i>
                        </div>
                        <h3 class="font-bold text-2xl mb-4">Unikalne Prezenty</h3>
                        <p class="text-gray-600">Pamiątki na każdą okazję: śluby, chrzciny, jubileusze i wiele innych.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Realizacje -->
        <section id="portfolio" class="py-24 bg-stone-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-4xl font-bold mb-4 text-stone-900">Moje Realizacje</h2>
                <div class="w-24 h-1.5 bg-wood-600 mx-auto rounded-full mb-16"></div>
                <div id="main-categories-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 text-left"></div>
            </div>
        </section>

        <!-- Kontakt -->
        <section id="contact" class="py-24 bg-white border-t border-stone-100">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                 <h2 class="text-4xl font-bold mb-8">Kontakt i Wycena</h2>
                 <p class="mb-12 text-gray-600 text-lg">Masz pomysł na projekt? Napisz do mnie, a pomogę Ci go zrealizować i przygotuję indywidualną wycenę.</p>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center p-8 bg-stone-50 rounded-2xl border border-stone-100">
                        <i class="fa-solid fa-envelope text-wood-600 text-3xl mb-4"></i>
                        <span class="font-bold text-xl">pkatlowski@gmail.com</span>
                    </div>
                    <div class="flex flex-col items-center p-8 bg-stone-50 rounded-2xl border border-stone-100">
                        <i class="fa-solid fa-phone text-wood-600 text-3xl mb-4"></i>
                        <span class="font-bold text-xl">+48 123 456 789</span>
                    </div>
                 </div>
            </div>
        </section>
    </div>

    <!-- WIDOKI DYNAMICZNE -->
    <div id="subcategory-view" class="hidden min-h-screen bg-white pt-32 pb-20 fade-in">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <button onclick="goHome()" class="mb-8 flex items-center text-wood-600 font-bold hover:translate-x-[-5px] transition-transform"><i class="fa-solid fa-arrow-left mr-2"></i> Powrót do głównych kategorii</button>
            <h2 id="subcategory-title" class="text-4xl font-bold text-stone-900 mb-4">Wybierz produkt</h2>
            <div id="subcategory-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8"></div>
        </div>
    </div>

    <div id="gallery-view" class="hidden min-h-screen bg-white pt-32 pb-20 fade-in">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <button id="back-to-sub-btn" class="mb-8 flex items-center text-wood-600 font-bold hover:translate-x-[-5px] transition-transform"><i class="fa-solid fa-arrow-left mr-2"></i> Powrót do listy produktów</button>
            <div class="mb-10">
                <h2 id="gallery-title" class="text-4xl font-bold text-stone-900 mb-2">Galeria Zdjęć</h2>
                <div id="gallery-product-info" class="text-stone-500 text-lg"></div>
            </div>
            <div id="gallery-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
        </div>
    </div>

    <!-- LIGHTBOX -->
    <div id="lightbox" class="fixed inset-0 z-[1000] bg-black/95 hidden flex items-center justify-center p-4 transition-opacity duration-300 opacity-0 cursor-pointer" onclick="closeLightbox()">
        <div class="relative max-w-5xl max-h-screen w-full flex flex-col items-center justify-center" onclick="event.stopPropagation()">
            <img id="lightbox-img" src="" alt="Powiększenie" class="lightbox-img rounded-lg">
            <button class="absolute -top-12 right-0 text-white hover:text-wood-500" onclick="closeLightbox()"><i class="fa-solid fa-xmark text-4xl"></i></button>
        </div>
    </div>

    <!-- PANEL ADMINISTRATORA -->
    <div id="admin-panel" class="fixed inset-0 z-[2000] bg-black/40 backdrop-blur-sm hidden items-center justify-center p-4 sm:p-10">
        <div class="bg-stone-900 text-white w-full max-w-6xl h-full max-h-[90vh] rounded-3xl overflow-hidden flex flex-col sm:flex-row shadow-2xl border border-white/10">
            <!-- Sidebar -->
            <div class="w-full sm:w-64 bg-stone-950 border-r border-white/5 p-6 flex flex-col">
                <h2 class="text-xl font-bold mb-10 text-wood-500 flex items-center gap-2 uppercase tracking-widest">
                    <i class="fa-solid fa-gears"></i> Zarządzanie
                </h2>
                <nav class="space-y-2 flex-1">
                    <button onclick="switchAdminView('hero-gallery')" id="btn-hero-gallery" class="admin-sidebar-item w-full text-left px-4 py-3 rounded-xl hover:bg-white/5 transition flex items-center gap-3">
                        <i class="fa-solid fa-images"></i> Galeria Tytułowa
                    </button>
                    <button onclick="switchAdminView('categories')" id="btn-categories" class="admin-sidebar-item w-full text-left px-4 py-3 rounded-xl hover:bg-white/5 transition flex items-center gap-3">
                        <i class="fa-solid fa-folder-tree"></i> Kategorie
                    </button>
                    <button onclick="switchAdminView('products')" id="btn-products" class="admin-sidebar-item w-full text-left px-4 py-3 rounded-xl hover:bg-white/5 transition flex items-center gap-3">
                        <i class="fa-solid fa-box-open"></i> Produkty i Zdjęcia
                    </button>
                    <button onclick="switchAdminView('calculator')" id="btn-calculator" class="admin-sidebar-item w-full text-left px-4 py-3 rounded-xl hover:bg-white/5 transition flex items-center gap-3">
                        <i class="fa-solid fa-calculator"></i> Kalkulator Lasera
                    </button>
                </nav>
                <button onclick="toggleAdminPanel()" class="mt-auto pt-4 text-stone-500 hover:text-white transition flex items-center gap-2 text-sm border-t border-white/10">
                    <i class="fa-solid fa-xmark"></i> Zamknij Panel
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-6 sm:p-10 bg-stone-900 text-white">
                
                <!-- Widok: Kalkulator Lasera (Excel Style) -->
                <div id="view-calculator" class="admin-view hidden space-y-8">
                    <header>
                        <h3 class="text-3xl font-bold mb-2">Kalkulator Wyceny Projektu</h3>
                        <p class="text-stone-400">Model oparty na arkuszu kalkulacyjnym.</p>
                    </header>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-stone-800 p-6 rounded-2xl border border-white/5 space-y-6">
                            <h4 class="font-bold text-wood-500 uppercase text-xs border-b border-white/5 pb-2">Parametry Wejściowe</h4>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-[10px] text-stone-400 uppercase font-bold mb-1">Szerokość (mm)</label>
                                    <input type="number" id="calc-width-mm" class="calc-input" value="100" oninput="runLaserCalculator()">
                                </div>
                                <div>
                                    <label class="block text-[10px] text-stone-400 uppercase font-bold mb-1">Wysokość (mm)</label>
                                    <input type="number" id="calc-height-mm" class="calc-input" value="100" oninput="runLaserCalculator()">
                                </div>
                            </div>

                            <div>
                                <label class="block text-[10px] text-stone-400 uppercase font-bold mb-1">Czas Lasera (min)</label>
                                <input type="number" id="calc-time-laser" class="calc-input" value="10" oninput="runLaserCalculator()">
                            </div>

                            <div class="pt-4 border-t border-white/5 space-y-4">
                                <h4 class="font-bold text-stone-500 uppercase text-[10px]">Stawki i Narzuty</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-[10px] text-stone-400 uppercase mb-1">Laser PLN/min</label>
                                        <input type="number" step="0.01" id="calc-rate-laser-min" class="calc-input" oninput="runLaserCalculator()">
                                    </div>
                                    <div>
                                        <label class="block text-[10px] text-stone-400 uppercase mb-1">Materiał PLN/cm²</label>
                                        <input type="number" step="0.0001" id="calc-rate-cm2" class="calc-input" oninput="runLaserCalculator()">
                                    </div>
                                    <div>
                                        <label class="block text-[10px] text-stone-400 uppercase mb-1">Overhead (%)</label>
                                        <input type="number" id="calc-overhead" class="calc-input" oninput="runLaserCalculator()">
                                    </div>
                                    <div>
                                        <label class="block text-[10px] text-stone-400 uppercase mb-1">Marża (%)</label>
                                        <input type="number" id="calc-margin" class="calc-input" oninput="runLaserCalculator()">
                                    </div>
                                </div>
                            </div>
                            <button onclick="saveCalcSettings()" class="bg-wood-600 w-full py-3 rounded-xl font-bold">Zapisz stawki w chmurze</button>
                        </div>

                        <div class="bg-stone-950 p-8 rounded-2xl border-2 border-wood-600/30 flex flex-col justify-center text-white">
                            <h4 class="text-xl font-bold mb-6 border-b border-white/5 pb-4">Rozliczenie Projektu</h4>
                            <div class="space-y-4 text-sm">
                                <div class="excel-row"><span>Koszt materiału:</span> <span id="res-material">0.00 PLN</span></div>
                                <div class="excel-row"><span>Koszt pracy lasera:</span> <span id="res-laser">0.00 PLN</span></div>
                                <div class="excel-row"><span>Koszty stałe (Overhead):</span> <span id="res-overhead">0.00 PLN</span></div>
                                <div class="excel-row text-wood-500 font-bold border-t border-white/10 pt-4"><span>Suma kosztów (Netto):</span> <span id="res-total-cost">0.00 PLN</span></div>
                            </div>
                            
                            <div class="mt-10 text-center">
                                <p class="text-[10px] uppercase text-stone-500 font-bold tracking-widest mb-2">Sugerowana Cena dla klienta</p>
                                <div id="calc-result-final-price" class="text-6xl font-black">0.00 PLN</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pozostałe widoki CMS zostaną wypełnione przez JS -->
                <div id="view-hero-gallery" class="admin-view hidden space-y-8"></div>
                <div id="view-categories" class="admin-view hidden space-y-8"></div>
                <div id="view-products" class="admin-view hidden space-y-8"></div>

            </div>
        </div>
    </div>

    <footer class="bg-stone-950 text-stone-500 py-16 text-center text-sm border-t border-white/5">
        <div class="max-w-7xl mx-auto px-4 space-y-6 flex flex-col md:flex-row justify-between items-center">
            <h2 class="text-xl font-bold text-wood-600 italic">Xeomsc FusionArt</h2>
            <p>&copy; 2024 Wszystkie prawa zastrzeżone. <button id="admin-footer-btn" onclick="toggleAdminPanel()" class="hidden hover:text-white underline ml-2">Panel Zarządzania</button></p>
        </div>
    </footer>

    <!-- LOGIKA SYSTEMU (FIREBASE + CMS) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = JSON.parse(__firebase_config || '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'xeomsc-fusionart';
        
        let db, auth, siteData = {};

        const initialData = {
            heroItems: [{ id: 1, type: 'image', url: 'https://images.unsplash.com/photo-1542332213-31f87348057f?q=80&w=2070' }],
            categories: {},
            galleries: {},
            calcSettings: { rateLaserMin: 0.50, rateCm2: 0.0038, overhead: 10, margin: 20 }
        };

        // --- RENDEROWANIE GŁÓWNE ---
        function renderHero() {
            const container = document.getElementById('hero-carousel-container');
            if (!container || !siteData.heroItems) return;
            container.innerHTML = siteData.heroItems.map((it, idx) => `
                <div class="hero-slide ${idx === 0 ? 'active' : ''}">
                    ${it.type === 'image' ? `<img src="${it.url}" class="w-full h-full object-cover">` : `<video src="${it.url}" class="w-full h-full object-cover" muted autoplay loop></video>`}
                </div>
            `).join('');
            
            let cur = 0;
            setInterval(() => {
                const slides = document.querySelectorAll('.hero-slide');
                if (slides.length < 2) return;
                slides[cur].classList.remove('active');
                cur = (cur + 1) % slides.length;
                slides[cur].classList.add('active');
            }, 6000);
        }

        function renderMain() {
            const grid = document.getElementById('main-categories-grid');
            if (!grid) return; grid.innerHTML = '';
            Object.entries(siteData.categories).forEach(([id, c]) => {
                const div = document.createElement('div');
                div.className = "bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-2xl transition cursor-pointer border border-stone-100 fade-in";
                div.onclick = () => window.openSubcategories(id);
                div.innerHTML = `<div class="h-64 overflow-hidden"><img src="${c.image || 'https://via.placeholder.com/400'}" class="w-full h-full object-cover"></div><div class="p-8"><h3 class="font-bold text-xl">${c.title}</h3><p class="text-stone-500 text-sm mt-2">Zobacz realizacje</p></div>`;
                grid.appendChild(div);
            });
        }

        // --- KALKULATOR (EXCEL LOGIC) ---
        window.runLaserCalculator = () => {
            const w = parseFloat(document.getElementById('calc-width-mm').value) || 0;
            const h = parseFloat(document.getElementById('calc-height-mm').value) || 0;
            const time = parseFloat(document.getElementById('calc-time-laser').value) || 0;
            const rl = parseFloat(document.getElementById('calc-rate-laser-min').value) || 0;
            const rc = parseFloat(document.getElementById('calc-rate-cm2').value) || 0;
            const oh = parseFloat(document.getElementById('calc-overhead').value) || 0;
            const ma = parseFloat(document.getElementById('calc-margin').value) || 0;

            const area = (w * h) / 100;
            const costM = area * rc;
            const costL = time * rl;
            const baseCost = costM + costL;
            const totalC = baseCost * (1 + (oh / 100));
            const finalP = totalC * (1 + (ma / 100));

            document.getElementById('res-material').textContent = costM.toFixed(2) + " PLN";
            document.getElementById('res-laser').textContent = costL.toFixed(2) + " PLN";
            document.getElementById('res-overhead').textContent = (totalC - baseCost).toFixed(2) + " PLN";
            document.getElementById('res-total-cost').textContent = totalC.toFixed(2) + " PLN";
            document.getElementById('calc-result-final-price').textContent = finalP.toFixed(2) + " PLN";
        };

        window.saveCalcSettings = async () => {
            siteData.calcSettings = {
                rateLaserMin: parseFloat(document.getElementById('calc-rate-laser-min').value),
                rateCm2: parseFloat(document.getElementById('calc-rate-cm2').value),
                overhead: parseFloat(document.getElementById('calc-overhead').value),
                margin: parseFloat(document.getElementById('calc-margin').value)
            };
            await saveData(); alert("Stawki zapisane!");
        };

        // --- CMS I ADMIN ---
        window.switchAdminView = (id) => {
            document.querySelectorAll('.admin-view').forEach(v => v.classList.add('hidden'));
            document.querySelectorAll('.admin-sidebar-item').forEach(b => b.classList.remove('active'));
            document.getElementById(`view-${id}`).classList.remove('hidden');
            document.getElementById(`btn-${id}`).classList.add('active');
            
            if (id === 'calculator') {
                const s = siteData.calcSettings;
                document.getElementById('calc-rate-laser-min').value = s.rateLaserMin;
                document.getElementById('calc-rate-cm2').value = s.rateCm2;
                document.getElementById('calc-overhead').value = s.overhead;
                document.getElementById('calc-margin').value = s.margin;
                window.runLaserCalculator();
            } else if (id === 'hero-gallery') renderHeroAdmin();
            else if (id === 'categories') renderCategoriesAdmin();
            else if (id === 'products') renderProductsAdmin();
        };

        function renderHeroAdmin() {
            const container = document.getElementById('view-hero-gallery');
            container.innerHTML = `
                <h3 class="text-2xl font-bold mb-6">Zarządzaj Karuzelą Startową</h3>
                <div class="bg-black/20 p-6 rounded-2xl space-y-4 mb-6">
                    <input id="h-url" class="calc-input" placeholder="Adres URL zdjęcia/wideo">
                    <select id="h-type" class="calc-input text-white"><option value="image">Zdjęcie</option><option value="video">Wideo</option></select>
                    <button id="add-h-btn" class="bg-wood-600 w-full p-4 rounded-xl font-bold">Dodaj do karuzeli</button>
                </div>
                <div class="space-y-2">${siteData.heroItems.map((h, i) => `<div class="bg-black/40 p-4 rounded-xl flex justify-between items-center text-xs opacity-60"><span>${h.url}</span><button onclick="window.delHero(${i})" class="text-red-500 p-2"><i class="fa-solid fa-trash"></i></button></div>`).join('')}</div>
            `;
            document.getElementById('add-h-btn').onclick = () => {
                const u = document.getElementById('h-url').value;
                if(u) { siteData.heroItems.push({type: document.getElementById('h-type').value, url: u}); saveData(); renderHeroAdmin(); }
            };
        }

        function renderCategoriesAdmin() {
            const container = document.getElementById('view-categories');
            container.innerHTML = `
                <h3 class="text-2xl font-bold mb-6 text-white">Zarządzaj Kategoriami</h3>
                <div class="bg-black/20 p-6 rounded-2xl space-y-4 mb-6">
                    <input id="cat-t" class="calc-input" placeholder="Tytuł kategorii">
                    <input id="cat-i" class="calc-input" placeholder="Link do okładki">
                    <button id="add-cat-btn" class="bg-wood-600 w-full p-4 rounded-xl font-bold">Utwórz kategorię</button>
                </div>
                <div class="space-y-2">${Object.keys(siteData.categories).map(k => `<div class="bg-black/40 p-4 rounded-xl flex justify-between"><span>${siteData.categories[k].title}</span><button onclick="window.delCat('${k}')" class="text-red-500 font-bold">USUŃ</button></div>`).join('')}</div>
            `;
            document.getElementById('add-cat-btn').onclick = () => {
                const t = document.getElementById('cat-t').value;
                if(t) {
                    const id = 'c' + Date.now();
                    siteData.categories[id] = { title: t, image: document.getElementById('cat-i').value, subcategories: [] };
                    saveData(); renderCategoriesAdmin();
                }
            };
        }

        function renderProductsAdmin() {
            const container = document.getElementById('view-products');
            container.innerHTML = `
                <h3 class="text-2xl font-bold mb-6 text-white">Nowy Produkt</h3>
                <div class="bg-black/20 p-6 rounded-2xl space-y-4 mb-10">
                    <select id="p-cat" class="calc-input text-white">${Object.keys(siteData.categories).map(k => `<option value="${k}">${siteData.categories[k].title}</option>`).join('')}</select>
                    <input id="p-t" class="calc-input" placeholder="Nazwa produktu">
                    <input id="p-i" class="calc-input" placeholder="Miniatura (link URL)">
                    <button id="p-btn" class="bg-wood-600 w-full p-4 rounded-xl font-bold">Dodaj Produkt</button>
                </div>
                <hr class="border-white/5 my-10">
                <h3 class="text-2xl font-bold mb-6 text-white text-center">Dodaj zdjęcia do realizacji</h3>
                <div class="bg-black/20 p-6 rounded-2xl space-y-4 mb-10">
                    <select id="p-gal-select" class="calc-input text-white">${Object.keys(siteData.categories).flatMap(k => siteData.categories[k].subcategories.map(s => `<option value="${s.id}">${siteData.categories[k].title} > ${s.title}</option>`)).join('')}</select>
                    <input id="gal-img-url" class="calc-input" placeholder="Wklej link do zdjęcia">
                    <button id="gal-btn" class="bg-stone-600 w-full p-4 rounded-xl font-bold">Zapisz zdjęcie w galerii</button>
                </div>
            `;
            document.getElementById('p-btn').onclick = () => {
                const cid = document.getElementById('p-cat').value;
                const t = document.getElementById('p-t').value;
                if(cid && t) {
                    const sid = 's' + Date.now();
                    siteData.categories[cid].subcategories.push({ id: sid, title: t, image: document.getElementById('p-i').value });
                    siteData.galleries[sid] = { images: [] };
                    saveData(); alert("Dodano produkt!"); renderProductsAdmin();
                }
            };
            document.getElementById('gal-btn').onclick = () => {
                const sid = document.getElementById('p-gal-select').value;
                const url = document.getElementById('gal-img-url').value;
                if(sid && url) {
                    if(!siteData.galleries[sid]) siteData.galleries[sid] = { images: [] };
                    siteData.galleries[sid].images.push({ src: url });
                    saveData(); alert("Zdjęcie zapisane!"); document.getElementById('gal-img-url').value = "";
                }
            };
        }

        // --- POMOCNICZE ---
        window.openSubcategories = (id) => {
            const c = siteData.categories[id];
            document.getElementById('subcategory-title').textContent = c.title;
            const grid = document.getElementById('subcategory-grid'); grid.innerHTML = '';
            c.subcategories.forEach((s, i) => {
                const div = document.createElement('div');
                div.className = "bg-white rounded-3xl overflow-hidden border border-stone-100 cursor-pointer hover:shadow-2xl transition relative group";
                div.onclick = () => window.openGallery(s.id, s.title, id);
                div.innerHTML = `<img src="${s.image}" class="h-64 w-full object-cover"><div class="p-8 flex justify-between items-center"><span class="font-bold text-xl">${s.title}</span><button onclick="event.stopPropagation(); window.delSub('${id}',${i})" class="admin-controls text-red-500 p-2"><i class="fa-solid fa-trash"></i></button></div>`;
                grid.appendChild(div);
            });
            document.getElementById('main-content').classList.add('hidden');
            document.getElementById('subcategory-view').classList.remove('hidden'); window.scrollTo(0,0);
        };

        window.openGallery = (sid, title, cid) => {
            const g = siteData.galleries[sid] || { images: [] };
            document.getElementById('gallery-title').textContent = title;
            document.getElementById('back-to-sub-btn').onclick = () => window.openSubcategories(cid);
            const grid = document.getElementById('gallery-grid'); grid.innerHTML = '';
            g.images.forEach((img, i) => {
                const div = document.createElement('div');
                div.className = "relative aspect-square rounded-2xl overflow-hidden cursor-pointer shadow-lg group";
                div.onclick = () => window.openLightbox(img.src);
                div.innerHTML = `<img src="${img.src}" class="w-full h-full object-cover"><button onclick="event.stopPropagation(); window.delImg('${sid}',${i},'${cid}','${title}')" class="admin-controls absolute top-4 right-4 bg-red-500 text-white p-2 rounded-lg opacity-0 group-hover:opacity-100 transition"><i class="fa-solid fa-trash"></i></button>`;
                grid.appendChild(div);
            });
            document.getElementById('subcategory-view').classList.add('hidden');
            document.getElementById('gallery-view').classList.remove('hidden'); window.scrollTo(0,0);
        };

        window.delHero = (i) => { siteData.heroItems.splice(i,1); saveData(); renderHeroAdmin(); renderHero(); };
        window.delCat = (k) => { if(confirm("Usunąć całą kategorię?")) { delete siteData.categories[k]; saveData(); renderCategoriesAdmin(); renderMain(); }};
        window.delSub = (cid, i) => { if(confirm("Usunąć produkt?")) { siteData.categories[cid].subcategories.splice(i,1); saveData(); window.openSubcategories(cid); }};
        window.delImg = (sid, i, cid, t) => { if(confirm("Usunąć zdjęcie?")) { siteData.galleries[sid].images.splice(i,1); saveData(); window.openGallery(sid, t, cid); }};
        window.openLightbox = (src) => { document.getElementById('lightbox-img').src = src; const lb = document.getElementById('lightbox'); lb.classList.replace('hidden','flex'); setTimeout(()=>lb.classList.replace('opacity-0','opacity-100'),10); };
        window.closeLightbox = () => { const lb = document.getElementById('lightbox'); lb.classList.replace('opacity-100','opacity-0'); setTimeout(()=>lb.classList.replace('flex','hidden'),300); };
        window.goHome = () => { document.getElementById('subcategory-view').classList.add('hidden'); document.getElementById('gallery-view').classList.add('hidden'); document.getElementById('main-content').classList.remove('hidden'); };
        window.handleLogin = () => { if(document.getElementById('login-user').value==='admin' && document.getElementById('login-pass').value==='12345') { sessionStorage.setItem('xeomsc_admin','true'); location.reload(); } else document.getElementById('login-error').classList.remove('hidden'); };
        window.handleLogout = () => { sessionStorage.removeItem('xeomsc_admin'); location.reload(); };
        window.toggleAdminPanel = () => { document.getElementById('admin-panel').classList.toggle('hidden'); if(!document.getElementById('admin-panel').classList.contains('hidden')) switchAdminView('hero-gallery'); };
        window.exitLogin = () => { document.getElementById('login-screen').classList.add('hidden'); window.location.hash = ''; };

        async function saveData() { localStorage.setItem('xeomsc_cached_data', JSON.stringify(siteData)); if(auth.currentUser) { await setDoc(doc(db, `artifacts/${appId}/public/data/siteConfig`, 'main'), siteData); } }

        async function start() {
            try {
                const appObj = initializeApp(firebaseConfig); auth = getAuth(appObj); db = getFirestore(appObj);
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) await signInWithCustomToken(auth, __initial_auth_token); else await signInAnonymously(auth);
                onAuthStateChanged(auth, (u) => { if(u) { const docRef = doc(db, `artifacts/${appId}/public/data/siteConfig`, 'main'); onSnapshot(docRef, (snap) => { if (snap.exists()) { siteData = snap.data(); localStorage.setItem('xeomsc_cached_data', JSON.stringify(siteData)); renderHero(); renderMain(); } }); if(sessionStorage.getItem('xeomsc_admin')==='true') { document.body.classList.add('is-admin'); document.getElementById('admin-bar').classList.remove('hidden'); document.getElementById('admin-footer-btn').classList.remove('hidden'); } } });
            } catch (e) { renderHero(); renderMain(); }
        }

        siteData = JSON.parse(localStorage.getItem('xeomsc_cached_data')) || initialData;
        renderHero(); renderMain(); start();
        if(window.location.hash === '#admin') document.getElementById('login-screen').classList.remove('hidden');
    </script>
</body>
</html>